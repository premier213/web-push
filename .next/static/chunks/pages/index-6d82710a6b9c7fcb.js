(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3098:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(3130)}])},3130:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return b},pusher:function(){return h}});var r=t(7135),i=t(9938),o=t(1527),c=t(959),s=t(5665),u=t.n(s),a=t(6338).Z.create({baseURL:"https://tjmkk.com/api",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer 219|pF1XeLx86dlua93Sb4vkKtze5skVsDvPlNU5TV6se09eff20"}}),l=t(5830),f=function(e){for(var n=(e+"=".repeat((4-e.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),t=window.atob(n),r=new Uint8Array(t.length),i=0;i<t.length;++i)r[i]=t.charCodeAt(i);return r},p="socket.tjmkk.com",h=new(t.n(l)())("56d56355b6cc996b754bab712e42aae6",{cluster:"mt1",httpHost:p,httpPort:Number(6002),wsHost:p,wsPort:Number(6002),authorizer:function(e){return{authorize:function(n,t){a.post("/broadcasting/auth",{socket_id:n,channel_name:e.name}).then((function(e){return t(null,e.data)})).catch((function(e){return t(new Error("Error occurred"),e)}))}}}}),b=function(){var e=(0,c.useState)(!1),n=e[0],t=e[1],s=(0,c.useState)(null),a=s[0],l=s[1],p=(0,c.useState)(null),b=p[0],d=p[1];(0,c.useEffect)((function(){"serviceWorker"in navigator&&window.addEventListener("load",(function(){navigator.serviceWorker.register("/sw.js").then((function(e){console.log("Service Worker registered with scope:",e.scope),h.subscribe("private-rates.1").bind("rates.update.price",(function(e){console.log("\ud83c\udfaf #61-pages/index.tsx",e),"granted"===Notification.permission&&new Notification("New Notification",{body:e.price_buy,icon:"/icon.png"})}))})).catch((function(e){console.error("Service Worker registration failed:",e)}))}))}),[]),(0,c.useEffect)((function(){"serviceWorker"in navigator&&void 0!==window.workbox&&navigator.serviceWorker.ready.then((function(e){e.pushManager.getSubscription().then((function(e){!e||e.expirationTime&&Date.now()>e.expirationTime-3e5||(l(e),t(!0))})),d(e)}))}),[]);var g=function(){var e=(0,r.Z)((function(e){var n;return(0,i.__generator)(this,(function(r){switch(r.label){case 0:return e.preventDefault(),[4,b.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:f("BOGx_KFrFsYBkj5BwrLkmszjGOUOpaXAxA4ppMLDQ-ZMmQZs68p4J29Snq_QV8ihOcWf-88BGYc9OIThfi4iFFc")})];case 1:return n=r.sent(),console.log("\ud83d\ude80 ~ subscribeButtonOnClick ~ sub:",n),l(n),t(!0),console.log("web push subscribed!"),console.log(n),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),w=function(){var e=(0,r.Z)((function(e){return(0,i.__generator)(this,(function(n){switch(n.label){case 0:return e.preventDefault(),[4,a.unsubscribe()];case 1:return n.sent(),l(null),t(!1),console.log("web push unsubscribed!"),[2]}}))}));return function(n){return e.apply(this,arguments)}}(),v=function(){var e=(0,r.Z)((function(e){return(0,i.__generator)(this,(function(e){return[2]}))}));return function(n){return e.apply(this,arguments)}}();return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(u(),{children:(0,o.jsx)("title",{children:"next-pwa example"})}),(0,o.jsx)("h1",{children:"Next.js + PWA = AWESOME!"}),(0,o.jsx)("button",{onClick:g,disabled:n,children:"Subscribe"}),(0,o.jsx)("button",{onClick:w,disabled:!n,children:"Unsubscribe"}),(0,o.jsx)("button",{onClick:v,disabled:!n,children:"Send Notification"})]})}}},function(e){e.O(0,[774,932,888,179],(function(){return n=3098,e(e.s=n);var n}));var n=e.O();_N_E=n}]);